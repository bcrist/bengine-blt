#include "lua_blt.hpp"
#include <be/blt/blt.hpp>

/*!! include('common/binary_lua_module', {
   fn = require_load_file(be.fs.canonical('../meta/lua_blt.lua'), '@BLT core'),
   symbol = 'BE_BLT_COMPILED_LUA_MODULE',
   line_length = 150 }) !! 114 */
/* ################# !! GENERATED CODE -- DO NOT MODIFY !! ################# */
#define BE_BLT_COMPILED_LUA_MODULE_LENGTH 8063
#define BE_BLT_COMPILED_LUA_MODULE \
   "\33LuaS\0\31\223\r\n\32\n\4\b\4\b\bxV\0\0\0\0\0\0\0\0\0\0\0(w@\1\n@BLT core\0\0\0\0\0\0\0\0\0\1\22G\0\0\0\6\0@\0F@@\0\206\200@\0\306\300@\0\6\1A\0FAA" \
   "\0\206\201A\0\306\301A\0\6\2B\0FBB\0\206\202B\0\301\302\2\0\244\202\0\1\306\202B\0\1\3\3\0\344\202\0\1-\3\0\1KC\0\0J\3\203\206I\3\0\0\254\3\0\0\313\3" \
   "\0\0\v\4\0\0lD\0\0\b@\4\207l\204\0\0\b@\204\207l\304\0\0\b@\4\210l\4\1\0\b@\204\210\36\304\377\177\313\3\0\0\312\303\3\211,D\1\0\312\3\204\211,\204\1" \
   "\0\312\3\4\212,\304\1\0\312\3\204\212,\4\2\0\312\3\4\213,D\2\0\312\3\204\213,\204\2\0\312\3\4\214,\304\2\0\b\0\204\214\v\4\0\0l\4\3\0\b@\4\215^\304" \
   "\377\177,D\3\0\b\0\204\215,\204\3\0\b\0\4\216,\304\3\0\b\0\204\216,\4\4\0\b\0\4\217,D\4\0\b\0\204\217,\204\4\0\b\0\4\220,\304\4\0\b\0\204\220,\4\5\0\b" \
   "\0\4\221\b\0\311\221f\3\0\1&\0\200\0\45\0\0\0\4\6table\4\5math\4\6error\4\5type\4\aselect\4\5next\4\5load\4\ttostring\4\rsetmetatable\4\3_G\4\brequire" \
   "\4\6be.fs\4\bbe.util\4\bcompile\4\rget_template\4\26register_template_dir\4\27register_template_file\4\31register_template_string\4\b__index\4\5push\4" \
   "\4pop\4\4get\4\4ref\4\6write\4\tcoalesce\4\fcreate_ctx_\4\rtable_cache_\4\5fif_\4\fis_sequence\4\fgsub_escape\4\6pgsub\4\bexplode\4\4pad\4\5rpad\4\5lp" \
   "ad\4\3nl\4\2\n\1\0\0\0\1\0\25\0\0\0\0\26\0\0\0\36\0\0\0\1\0\4\20\0\0\0F\0@\0b@\0\0\36\0\0\200&\0\200\0F@@\0b\0\0\0\36\0\1\200F\200\300\0\200\0\0\0\306" \
   "@@\0d\200\200\1\0\0\200\0F\0@\0\200\0\0\0d@\0\1&\0\200\0\3\0\0\0\4\vdependency\4\troot_dir\4\22ancestor_relative\2\0\0\0\1\t\1\n\0\0\0\0\20\0\0\0\27\0" \
   "\0\0\27\0\0\0\27\0\0\0\30\0\0\0\32\0\0\0\32\0\0\0\32\0\0\0\33\0\0\0\33\0\0\0\33\0\0\0\33\0\0\0\33\0\0\0\35\0\0\0\35\0\0\0\35\0\0\0\36\0\0\0\1\0\0\0\5p" \
   "ath\0\0\0\0\20\0\0\0\2\0\0\0\aglobal\3fs\0$\0\0\0G\0\0\0\1\0\tT\0\0\0\42@\0\0\36\200\0\200E\0\0\0\201\0\0\0d@\0\1F\0\200\0_@\300\0\36\0\0\200f\0\0\1" \
   "\206\200@\1\300\0\0\0\6\301\300\1E\1\0\2$\1\0\1\244\200\0\0\242\0\0\0\36\200\3\200\305\0\200\2\0\1\0\1\344@\0\1\306\0A\1\0\1\0\1\344\200\0\1\6AA\3@\1" \
   "\200\1\201\201\1\0\300\1\0\0\1\302\1\0\235\1\2\3$\201\200\1H\0\1\0&\1\0\1\306\200@\1\0\1\0\0A\1\2\0\35A\1\2F\301\300\1\205\1\0\2d\1\0\1\344\200\0\0" \
   "\200\0\200\1\242\0\0\0\36\200\3\200\305\0\200\2\0\1\0\1\344@\0\1\306\0A\1\0\1\0\1\344\200\0\1\6AA\3@\1\200\1\201\201\1\0\300\1\0\0\1\302\1\0\235\1\2\3" \
   "$\201\200\1H\0\1\0&\1\0\1\306\200@\1\0\1\0\0A\301\1\0\35A\1\2F\301\300\1\205\1\0\2d\1\0\1\344\200\0\0\200\0\200\1\242\0\0\0\36\300\1\200\305\0\200\2\0" \
   "\1\0\1\344@\0\1\306@\302\3\0\1\0\1@\1\0\0\345\0\200\1\346\0\0\0\305\0\0\0\1\201\2\0@\1\0\0\201\301\2\0\35\201\1\2\344@\0\1&\0\200\0\f\0\0\0\4\33Templa" \
   "te must have a name!\0\4\nfind_file\4\aunpack\4\22get_file_contents\4\rrequire_load\4\2@\4\5.blt\4\5.lua\4\27register_template_file\4\35No template fo" \
   "und matching '\4\2'\b\0\0\0\1\2\1\17\1\n\1\0\1\20\1\16\1\v\0\0\0\0\0\0T\0\0\0\45\0\0\0\45\0\0\0&\0\0\0&\0\0\0&\0\0\0)\0\0\0*\0\0\0*\0\0\0\53\0\0\0.\0" \
   "\0\0.\0\0\0.\0\0\0.\0\0\0.\0\0\0.\0\0\0/\0\0\0/\0\0\0\60\0\0\0\60\0\0\0\60\0\0\0\61\0\0\0\61\0\0\0\61\0\0\0\62\0\0\0\62\0\0\0\62\0\0\0\62\0\0\0\62\0\0" \
   "\0\62\0\0\0\62\0\0\0\63\0\0\0\64\0\0\0\67\0\0\0\67\0\0\0\67\0\0\0\67\0\0\0\67\0\0\0\67\0\0\0\67\0\0\0\67\0\0\0\67\0\0\0\70\0\0\0\70\0\0\0\71\0\0\0\71" \
   "\0\0\0\71\0\0\0\72\0\0\0\72\0\0\0\72\0\0\0;\0\0\0;\0\0\0;\0\0\0;\0\0\0;\0\0\0;\0\0\0;\0\0\0<\0\0\0=\0\0\0@\0\0\0@\0\0\0@\0\0\0@\0\0\0@\0\0\0@\0\0\0@\0" \
   "\0\0@\0\0\0@\0\0\0A\0\0\0A\0\0\0B\0\0\0B\0\0\0B\0\0\0C\0\0\0C\0\0\0C\0\0\0C\0\0\0C\0\0\0F\0\0\0F\0\0\0F\0\0\0F\0\0\0F\0\0\0F\0\0\0G\0\0\0\a\0\0\0\16te" \
   "mplate_name\0\0\0\0T\0\0\0\texisting\6\0\0\0T\0\0\0\5path\17\0\0\0T\0\0\0\tcontents\27\0\0\0 \0\0\0\3fn\36\0\0\0 \0\0\0\tcontents1\0\0\0\72\0\0\0\3fn8" \
   "\0\0\0\72\0\0\0\b\0\0\0\6error\ntemplates\3fs\6table\16template_dirs\17add_dependency\5util\5_ENV\0I\0\0\0Q\0\0\0\1\0\a\21\0\0\0E\0\0\0\\\0\200\0\201" \
   "\0\0\0\300\0\200\0\1\1\0\0\250\300\0\200\206A\1\0\37\0\0\3\36\0\0\200&\0\200\0\247\200\376\177\215\0\300\0\306@\300\0\0\1\0\0\344\200\0\1\b\300\0\1&\0" \
   "\200\0\2\0\0\0\23\1\0\0\0\0\0\0\0\4\ncanonical\2\0\0\0\1\20\1\n\0\0\0\0\21\0\0\0J\0\0\0J\0\0\0K\0\0\0K\0\0\0K\0\0\0K\0\0\0L\0\0\0L\0\0\0L\0\0\0M\0\0\0" \
   "K\0\0\0P\0\0\0P\0\0\0P\0\0\0P\0\0\0P\0\0\0Q\0\0\0\6\0\0\0\5path\0\0\0\0\21\0\0\0\2n\2\0\0\0\21\0\0\0\f(for index)\5\0\0\0\v\0\0\0\f(for limit)\5\0\0\0" \
   "\v\0\0\0\v(for step)\5\0\0\0\v\0\0\0\2i\6\0\0\0\n\0\0\0\2\0\0\0\16template_dirs\3fs\0S\0\0\0d\0\0\0\2\0\b,\0\0\0\206\0@\0\300\0\0\0\244\200\0\1\242@\0" \
   "\0\36@\1\200\205\0\200\0\301@\0\0\0\1\0\0A\201\0\0\335@\201\1\244@\0\1b@\0\0\36\0\2\200\206\300@\0\300\0\0\0\244\200\0\1@\0\0\1b@\0\0\36\200\0\200\205" \
   "\0\200\0\301\0\1\0\244@\0\1\206@\0\1_@A\1\36@\1\200\205\0\200\0\301\200\1\0\0\1\200\0A\301\1\0\335@\201\1\244@\0\1\206\0B\0\300\0\0\0\244\200\0\1\305" \
   "\0\200\1\0\1\0\1AA\2\0\200\1\200\0\301\201\2\0]\301\201\2\344\200\200\1\210\300\200\0\346\0\0\1&\0\200\0\v\0\0\0\4\aexists\4\20Template file '\4\r' no" \
   "t found!\4\npath_stem\4\33Template must have a name!\0\4\23A template named '\4\22' already exists!\4\22get_file_contents\4\2@\4\5.blt\4\0\0\0\1\n\1\2" \
   "\1\17\1\f\0\0\0\0,\0\0\0T\0\0\0T\0\0\0T\0\0\0T\0\0\0T\0\0\0U\0\0\0U\0\0\0U\0\0\0U\0\0\0U\0\0\0U\0\0\0W\0\0\0W\0\0\0X\0\0\0X\0\0\0X\0\0\0X\0\0\0Y\0\0\0" \
   "Y\0\0\0Z\0\0\0Z\0\0\0Z\0\0\0]\0\0\0]\0\0\0]\0\0\0^\0\0\0^\0\0\0^\0\0\0^\0\0\0^\0\0\0^\0\0\0`\0\0\0`\0\0\0`\0\0\0a\0\0\0a\0\0\0a\0\0\0a\0\0\0a\0\0\0a\0" \
   "\0\0a\0\0\0b\0\0\0c\0\0\0d\0\0\0\4\0\0\0\5path\0\0\0\0,\0\0\0\16template_name\0\0\0\0,\0\0\0\bcontent\42\0\0\0,\0\0\0\tcompiled)\0\0\0,\0\0\0\4\0\0\0" \
   "\3fs\6error\ntemplates\bcompile\0f\0\0\0p\0\0\0\2\0\a\30\0\0\0b@\0\0\36\200\0\200\205\0\0\0\301\0\0\0\244@\0\1\206@\200\0_@@\1\36@\1\200\205\0\0\0\301" \
   "\200\0\0\0\1\200\0A\301\0\0\335@\201\1\244@\0\1\205\0\0\1\300\0\0\0\1\1\1\0@\1\200\0\201A\1\0\35\201\1\2\244\200\200\1H\200\200\0\246\0\0\1&\0\200\0\6" \
   "\0\0\0\4\33Template must have a name!\0\4\23A template named '\4\22' already exists!\4\2@\4\5.blt\3\0\0\0\1\2\1\17\1\f\0\0\0\0\30\0\0\0g\0\0\0g\0\0\0h" \
   "\0\0\0h\0\0\0h\0\0\0j\0\0\0j\0\0\0j\0\0\0k\0\0\0k\0\0\0k\0\0\0k\0\0\0k\0\0\0k\0\0\0m\0\0\0m\0\0\0m\0\0\0m\0\0\0m\0\0\0m\0\0\0m\0\0\0n\0\0\0o\0\0\0p\0" \
   "\0\0\3\0\0\0\astring\0\0\0\0\30\0\0\0\16template_name\0\0\0\0\30\0\0\0\tcompiled\25\0\0\0\30\0\0\0\3\0\0\0\6error\ntemplates\bcompile\0~\0\0\0\203\0\0" \
   "\0\2\0\4\24\0\0\0\207\0@\0\215@@\1\n\200\0\200\207\200@\0\307\0@\0\212@\200\1\205\0\0\0\300\0\200\0\244\200\0\1\n\200\200\201\207\300@\0_@A\1\36\300\0" \
   "\200\207\300@\0_\200A\1\36\0\0\200\203@\0\0\203\0\200\0\n\200\0\202&\0\200\0\a\0\0\0\4\2i\23\1\0\0\0\0\0\0\0\4\6stack\4\5type\4\6deref\4\6table\4\tuse" \
   "rdata\1\0\0\0\1\3\0\0\0\0\24\0\0\0\177\0\0\0\177\0\0\0\177\0\0\0\200\0\0\0\200\0\0\0\200\0\0\0\201\0\0\0\201\0\0\0\201\0\0\0\201\0\0\0\202\0\0\0\202\0" \
   "\0\0\202\0\0\0\202\0\0\0\202\0\0\0\202\0\0\0\202\0\0\0\202\0\0\0\202\0\0\0\203\0\0\0\2\0\0\0\5self\0\0\0\0\24\0\0\0\6value\0\0\0\0\24\0\0\0\1\0\0\0\5t" \
   "ype\0\205\0\0\0\215\0\0\0\1\0\4\32\0\0\0G\0@\0 @\200\200\36@\5\200G\200@\0\207\0@\0J\300@\1G\0@\0N@\300\0\n@\0\200G\200@\0\207\0@\0G\200\200\0\205\0\0" \
   "\0\300\0\200\0\244\200\0\1\n\200\0\202\207\0A\0_\200A\1\36\300\0\200\207\0A\0_\300A\1\36\0\0\200\203@\0\0\203\0\200\0\n\200\200\202&\0\200\0\b\0\0\0\4" \
   "\2i\23\1\0\0\0\0\0\0\0\4\6stack\0\4\5type\4\6deref\4\6table\4\tuserdata\1\0\0\0\1\3\0\0\0\0\32\0\0\0\206\0\0\0\206\0\0\0\206\0\0\0\207\0\0\0\207\0\0\0" \
   "\207\0\0\0\210\0\0\0\210\0\0\0\210\0\0\0\211\0\0\0\211\0\0\0\211\0\0\0\212\0\0\0\212\0\0\0\212\0\0\0\212\0\0\0\213\0\0\0\213\0\0\0\213\0\0\0\213\0\0\0" \
   "\213\0\0\0\213\0\0\0\213\0\0\0\213\0\0\0\213\0\0\0\215\0\0\0\2\0\0\0\5self\0\0\0\0\32\0\0\0\6value\f\0\0\0\31\0\0\0\1\0\0\0\5type\0\217\0\0\0\230\0\0" \
   "\0\2\0\4\20\0\0\0b@\0\0\36\0\0\200A\0\0\0\207@@\0!@\0\1\36\300\0\200\207\200@\0\207\300@\1\246\0\0\1\36\0\1\200\207\200@\0\307@@\0\316@\200\1\207\300" \
   "\0\1\246\0\0\1&\0\200\0\4\0\0\0\23\0\0\0\0\0\0\0\0\4\2i\4\6stack\23\1\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\20\0\0\0\220\0\0\0\220\0\0\0\221\0\0\0\223\0\0\0" \
   "\223\0\0\0\223\0\0\0\224\0\0\0\224\0\0\0\224\0\0\0\224\0\0\0\226\0\0\0\226\0\0\0\226\0\0\0\226\0\0\0\226\0\0\0\230\0\0\0\2\0\0\0\5self\0\0\0\0\20\0\0" \
   "\0\6level\0\0\0\0\20\0\0\0\0\0\0\0\0\232\0\0\0\244\0\0\0\3\0\5\16\0\0\0_\0@\1\36\0\0\200\246\0\0\1\307@@\0\342@\0\0\36@\0\200\304\0\0\0\346\0\0\1\307" \
   "\200@\0\a\301@\0\307\0\201\1\307@\200\1\346\0\0\1&\0\200\0\4\0\0\0\0\4\6deref\4\6stack\4\2i\0\0\0\0\0\0\0\0\16\0\0\0\233\0\0\0\233\0\0\0\234\0\0\0\237" \
   "\0\0\0\237\0\0\0\237\0\0\0\240\0\0\0\240\0\0\0\243\0\0\0\243\0\0\0\243\0\0\0\243\0\0\0\243\0\0\0\244\0\0\0\3\0\0\0\5self\0\0\0\0\16\0\0\0\4key\0\0\0\0" \
   "\16\0\0\0\flocal_value\0\0\0\0\16\0\0\0\0\0\0\0\0\246\0\0\0\257\0\0\0\1\1\n\27\0\0\0A\0\0\0\205\0\0\0\301@\0\0-\1\0\0\244\200\0\0\301\0\0\0h@\3\200G" \
   "\201@\0M\1\300\2\205\1\0\0\300\1\0\2-\2\0\0\244\201\0\0_\300@\3\36@\1\200\307\1A\0\5\2\200\0@\2\0\3$\202\0\1\312\1\202\2\n@\1\201g\0\374\177&\0\200\0" \
   "\5\0\0\0\23\1\0\0\0\0\0\0\0\4\2\43\4\2n\0\4\4out\2\0\0\0\1\4\1\a\0\0\0\0\27\0\0\0\247\0\0\0\247\0\0\0\247\0\0\0\247\0\0\0\247\0\0\0\247\0\0\0\247\0\0" \
   "\0\250\0\0\0\250\0\0\0\251\0\0\0\251\0\0\0\251\0\0\0\251\0\0\0\252\0\0\0\252\0\0\0\253\0\0\0\253\0\0\0\253\0\0\0\253\0\0\0\253\0\0\0\254\0\0\0\247\0\0" \
   "\0\257\0\0\0\a\0\0\0\5self\0\0\0\0\27\0\0\0\f(for index)\6\0\0\0\26\0\0\0\f(for limit)\6\0\0\0\26\0\0\0\v(for step)\6\0\0\0\26\0\0\0\2i\a\0\0\0\25\0\0" \
   "\0\2n\t\0\0\0\25\0\0\0\2v\r\0\0\0\25\0\0\0\2\0\0\0\aselect\ttostring\0\261\0\0\0\264\0\0\0\1\0\3\5\0\0\0F\0@\0\207@@\0d\200\0\1f\0\0\1&\0\200\0\2\0\0" \
   "\0\4\aconcat\4\4out\1\0\0\0\1\0\0\0\0\0\5\0\0\0\262\0\0\0\262\0\0\0\262\0\0\0\263\0\0\0\264\0\0\0\2\0\0\0\5self\0\0\0\0\5\0\0\0\4val\3\0\0\0\5\0\0\0\1" \
   "\0\0\0\6table\0\266\0\0\0\302\0\0\0\1\0\5\22\0\0\0K\200\1\0\213\0\0\0J\200\0\200J\200\300\200J\0\301\201J\200\301\202\213\0\0\0J\200\200\203J\200@\204" \
   "\205\0\0\0\300\0\200\0\5\1\200\0\244@\200\1\214@\302\0\0\1\0\0\244@\200\1f\0\0\1&\0\200\0\n\0\0\0\4\6stack\4\2i\23\0\0\0\0\0\0\0\0\4\5type\4\4nil\4\6d" \
   "eref\1\0\4\4out\4\2n\4\5push\2\0\0\0\1\b\1\17\0\0\0\0\22\0\0\0\267\0\0\0\270\0\0\0\270\0\0\0\271\0\0\0\272\0\0\0\273\0\0\0\274\0\0\0\274\0\0\0\275\0\0" \
   "\0\277\0\0\0\277\0\0\0\277\0\0\0\277\0\0\0\300\0\0\0\300\0\0\0\300\0\0\0\301\0\0\0\302\0\0\0\2\0\0\0\6value\0\0\0\0\22\0\0\0\5self\t\0\0\0\22\0\0\0\2" \
   "\0\0\0\rsetmetatable\tctx_meta\0\306\0\0\0\315\0\0\0\2\0\4\t\0\0\0\206\0\0\0\37\0@\1\36\300\0\200\300\0\200\0\344\200\200\0\200\0\200\1\b\200\0\0\246" \
   "\0\0\1&\0\200\0\1\0\0\0\0\1\0\0\0\1\20\0\0\0\0\t\0\0\0\307\0\0\0\310\0\0\0\310\0\0\0\311\0\0\0\311\0\0\0\311\0\0\0\312\0\0\0\314\0\0\0\315\0\0\0\3\0\0" \
   "\0\6value\0\0\0\0\t\0\0\0\5func\0\0\0\0\t\0\0\0\texisting\1\0\0\0\t\0\0\0\1\0\0\0\6cache\0\320\0\0\0\326\0\0\0\3\0\3\6\0\0\0\42\0\0\0\36@\0\200f\0\0\1" \
   "\36\0\0\200\246\0\0\1&\0\200\0\0\0\0\0\0\0\0\0\0\0\0\0\6\0\0\0\321\0\0\0\321\0\0\0\322\0\0\0\322\0\0\0\324\0\0\0\326\0\0\0\3\0\0\0\ncondition\0\0\0\0" \
   "\6\0\0\0\vtrue_value\0\0\0\0\6\0\0\0\ffalse_value\0\0\0\0\6\0\0\0\0\0\0\0\0\330\0\0\0\354\0\0\0\1\0\b(\0\0\0E\0\0\0\200\0\0\0d\200\0\1_\0\300\0\36@\0" \
   "\200C\0\0\0f\0\0\1E\0\200\0\200\0\0\0d\200\0\1\201@\0\0\305\0\0\0\0\1\200\0\344\200\0\1\37\200\300\1\36\200\1\200\215\300@\1\305\0\200\0\0\1\0\0@\1" \
   "\200\0\344\200\200\1@\0\200\1\36\300\374\177_\0\301\0\36@\0\200\303\0\0\0\346\0\0\1\301\300\0\0\0\1\0\1A\301\0\0\350\0\1\200\307\201\1\0\37\0\301\3\36" \
   "@\0\200\303\1\0\0\346\1\0\1\347@\376\177\303\0\200\0\346\0\0\1&\0\200\0\5\0\0\0\4\6table\23\0\0\0\0\0\0\0\0\4\anumber\23\1\0\0\0\0\0\0\0\0\2\0\0\0\1\3" \
   "\1\5\0\0\0\0(\0\0\0\331\0\0\0\331\0\0\0\331\0\0\0\331\0\0\0\331\0\0\0\332\0\0\0\332\0\0\0\335\0\0\0\335\0\0\0\335\0\0\0\336\0\0\0\337\0\0\0\337\0\0\0" \
   "\337\0\0\0\337\0\0\0\337\0\0\0\340\0\0\0\341\0\0\0\341\0\0\0\341\0\0\0\341\0\0\0\341\0\0\0\341\0\0\0\343\0\0\0\343\0\0\0\344\0\0\0\344\0\0\0\346\0\0\0" \
   "\346\0\0\0\346\0\0\0\346\0\0\0\347\0\0\0\347\0\0\0\347\0\0\0\350\0\0\0\350\0\0\0\346\0\0\0\353\0\0\0\353\0\0\0\354\0\0\0\a\0\0\0\6value\0\0\0\0(\0\0\0" \
   "\2k\n\0\0\0(\0\0\0\2n\v\0\0\0(\0\0\0\f(for index)\36\0\0\0\45\0\0\0\f(for limit)\36\0\0\0\45\0\0\0\v(for step)\36\0\0\0\45\0\0\0\2i\37\0\0\0$\0\0\0\2" \
   "\0\0\0\5type\5next\0\356\0\0\0\360\0\0\0\1\0\5\6\0\0\0L\0@\0\301@\0\0\1\201\0\0e\0\0\2f\0\0\0&\0\200\0\3\0\0\0\4\5gsub\4\33[\45(\45)\45.\45\45\45\53" \
   "\45-\45*\45\?\45[\45]\45^\45$]\4\5\45\45\45\60\0\0\0\0\0\0\0\0\6\0\0\0\357\0\0\0\357\0\0\0\357\0\0\0\357\0\0\0\357\0\0\0\360\0\0\0\1\0\0\0\bpattern\0" \
   "\0\0\0\6\0\0\0\0\0\0\0\0\362\0\0\0\364\0\0\0\2\1\6\b\0\0\0\214\0@\0\6A@\0@\1\200\0$\201\0\1m\1\0\0\245\0\0\0\246\0\0\0&\0\200\0\2\0\0\0\4\5gsub\4\fgsu" \
   "b_escape\1\0\0\0\0\0\0\0\0\0\b\0\0\0\363\0\0\0\363\0\0\0\363\0\0\0\363\0\0\0\363\0\0\0\363\0\0\0\363\0\0\0\364\0\0\0\2\0\0\0\4str\0\0\0\0\b\0\0\0\bpat" \
   "tern\0\0\0\0\b\0\0\0\1\0\0\0\5_ENV\0\366\0\0\0\r\1\0\0\3\0\r*\0\0\0\37\0\300\0\36\200\1\200\314@@\0A\201\0\0\201\301\0\0\344\200\0\2\0\0\200\1A\0\1\0" \
   "\203\0\200\0\301@\1\0\1A\1\0D\1\0\0\213\1\0\0\301\201\1\0\42\1\0\0\36\0\4\200\f\302A\0\200\2\200\0\300\2\200\1\33\3\0\1$\302\200\2@\1\200\4\0\1\0\4\42" \
   "\1\0\0\36\0\375\177\315A\301\3\f\2B\0\200\2\200\1\316BA\2$\202\0\2\212\1\202\3\315@\301\2\36\0\373\177\315A\301\3\f\2B\0\200\2\200\1$\202\200\1\212\1" \
   "\202\3\0\2\0\3@\2\200\3&\2\200\1&\0\200\0\t\0\0\0\0\4\5gsub\4\3\r\n\4\2\n\4\5[\r\n]\23\1\0\0\0\0\0\0\0\23\0\0\0\0\0\0\0\0\4\5find\4\4sub\0\0\0\0\0\0\0" \
   "\0*\0\0\0\367\0\0\0\367\0\0\0\370\0\0\0\370\0\0\0\370\0\0\0\370\0\0\0\370\0\0\0\371\0\0\0\372\0\0\0\375\0\0\0\375\0\0\0\375\0\0\0\376\0\0\0\377\0\0\0" \
   "\0\1\0\0\0\1\0\0\1\1\0\0\1\1\0\0\1\1\0\0\1\1\0\0\1\1\0\0\1\1\0\0\1\1\0\0\2\1\0\0\2\1\0\0\3\1\0\0\4\1\0\0\4\1\0\0\4\1\0\0\4\1\0\0\4\1\0\0\5\1\0\0\6\1\0" \
   "\0\t\1\0\0\n\1\0\0\n\1\0\0\n\1\0\0\n\1\0\0\f\1\0\0\f\1\0\0\f\1\0\0\r\1\0\0\b\0\0\0\4str\0\0\0\0*\0\0\0\nseparator\0\0\0\0*\0\0\0\vis_pattern\0\0\0\0*" \
   "\0\0\0\2c\f\0\0\0*\0\0\0\2s\f\0\0\0*\0\0\0\2e\f\0\0\0*\0\0\0\bresults\r\0\0\0*\0\0\0\2n\16\0\0\0*\0\0\0\0\0\0\0\0\17\1\0\0\32\1\0\0\2\0\t\30\0\0\0\42" \
   "\0\0\0\36@\0\200 \0@\0\36@\0\200\201@\0\0\246\0\0\1b@\0\0\36\0\0\200A\200\0\0\234\0\200\0\306\300@\0\22\201\0\0\344\200\0\1\f\1\301\0\200\1\200\1$\201" \
   "\200\1LA\301\0\301\1\0\0\17\302\0\1\16\2\2\0d\201\0\2\35A\1\2&\1\0\1&\0\200\0\6\0\0\0\23\1\0\0\0\0\0\0\0\4\1\4\2 \4\6floor\4\4rep\4\4sub\1\0\0\0\1\1\0" \
   "\0\0\0\30\0\0\0\20\1\0\0\20\1\0\0\20\1\0\0\20\1\0\0\21\1\0\0\21\1\0\0\23\1\0\0\23\1\0\0\24\1\0\0\26\1\0\0\27\1\0\0\27\1\0\0\27\1\0\0\30\1\0\0\30\1\0\0" \
   "\30\1\0\0\30\1\0\0\30\1\0\0\30\1\0\0\30\1\0\0\30\1\0\0\30\1\0\0\31\1\0\0\32\1\0\0\5\0\0\0\2n\0\0\0\0\30\0\0\0\5fill\0\0\0\0\30\0\0\0\nfill_size\n\0\0" \
   "\0\30\0\0\0\2i\r\0\0\0\30\0\0\0\4str\26\0\0\0\30\0\0\0\1\0\0\0\5math\0\34\1\0\0\37\1\0\0\3\0\a\t\0\0\0\300\0\0\0\6\1@\0\\\1\0\0NA\201\0\200\1\0\1$\201" \
   "\200\1\35\0\201\1&\0\0\1&\0\200\0\1\0\0\0\4\4pad\1\0\0\0\0\0\0\0\0\0\t\0\0\0\35\1\0\0\35\1\0\0\35\1\0\0\35\1\0\0\35\1\0\0\35\1\0\0\35\1\0\0\36\1\0\0" \
   "\37\1\0\0\3\0\0\0\4str\0\0\0\0\t\0\0\0\2n\0\0\0\0\t\0\0\0\5fill\0\0\0\0\t\0\0\0\1\0\0\0\5_ENV\0!\1\0\0$\1\0\0\3\0\6\t\0\0\0\306\0@\0\34\1\0\0\16\1\201" \
   "\0@\1\0\1\344\200\200\1\0\1\0\0\35\0\201\1&\0\0\1&\0\200\0\1\0\0\0\4\4pad\1\0\0\0\0\0\0\0\0\0\t\0\0\0\42\1\0\0\42\1\0\0\42\1\0\0\42\1\0\0\42\1\0\0\42" \
   "\1\0\0\42\1\0\0\43\1\0\0$\1\0\0\3\0\0\0\4str\0\0\0\0\t\0\0\0\2n\0\0\0\0\t\0\0\0\5fill\0\0\0\0\t\0\0\0\1\0\0\0\5_ENVG\0\0\0\1\0\0\0\2\0\0\0\3\0\0\0\4\0" \
   "\0\0\5\0\0\0\6\0\0\0\a\0\0\0\b\0\0\0\t\0\0\0\n\0\0\0\f\0\0\0\f\0\0\0\f\0\0\0\r\0\0\0\r\0\0\0\r\0\0\0\17\0\0\0\21\0\0\0\22\0\0\0\24\0\0\0\36\0\0\0!\0\0" \
   "\0\42\0\0\0G\0\0\0$\0\0\0Q\0\0\0I\0\0\0d\0\0\0S\0\0\0p\0\0\0f\0\0\0p\0\0\0s\0\0\0t\0\0\0\203\0\0\0~\0\0\0\215\0\0\0\205\0\0\0\230\0\0\0\217\0\0\0\244" \
   "\0\0\0\232\0\0\0\257\0\0\0\246\0\0\0\264\0\0\0\261\0\0\0\302\0\0\0\266\0\0\0\305\0\0\0\315\0\0\0\306\0\0\0\315\0\0\0\326\0\0\0\320\0\0\0\354\0\0\0\330" \
   "\0\0\0\360\0\0\0\356\0\0\0\364\0\0\0\362\0\0\0\r\1\0\0\366\0\0\0\32\1\0\0\17\1\0\0\37\1\0\0\34\1\0\0$\1\0\0!\1\0\0&\1\0\0(\1\0\0(\1\0\0\23\0\0\0\6tabl" \
   "e\1\0\0\0G\0\0\0\5math\2\0\0\0G\0\0\0\6error\3\0\0\0G\0\0\0\5type\4\0\0\0G\0\0\0\aselect\5\0\0\0G\0\0\0\5next\6\0\0\0G\0\0\0\5load\a\0\0\0G\0\0\0\ttos" \
   "tring\b\0\0\0G\0\0\0\rsetmetatable\t\0\0\0G\0\0\0\aglobal\n\0\0\0G\0\0\0\3fs\r\0\0\0G\0\0\0\5util\20\0\0\0G\0\0\0\bcompile\21\0\0\0G\0\0\0\2M\23\0\0\0" \
   "G\0\0\0\17add_dependency\25\0\0\0G\0\0\0\ntemplates\26\0\0\0 \0\0\0\16template_dirs\27\0\0\0 \0\0\0\tctx_meta!\0\0\0G\0\0\0\6cache1\0\0\0\64\0\0\0\1\0" \
   "\0\0\5_ENV"

/* ######################### END OF GENERATED CODE ######################### */

namespace be {
namespace belua {

///////////////////////////////////////////////////////////////////////////////
const luaL_Reg blt_module { "be.blt", open_blt };

///////////////////////////////////////////////////////////////////////////////
const luaL_Reg blt_compile_module { "be.blt.compile", open_blt_compile };

namespace {

///////////////////////////////////////////////////////////////////////////////
int blt_compile(lua_State* L) {
   std::size_t len;
   const char* input = luaL_tolstring(L, 1, &len);
   S output = blt::compile_blt(gsl::cstring_span<>(input, len));
   lua_pop(L, 1); // remove luaL_tolstring string

   S name = "blt_template";
   if (lua_gettop(L) >= 2) {
      const char* cname = luaL_tolstring(L, 2, &len);
      name.assign(cname, len);
   }

   lua_settop(L, 0);

   if (luaL_loadbufferx(L, output.data(), output.size(), name.c_str(), "t") != LUA_OK) {
      return lua_error(L);
   }
   return 1;
}

} // be::lua::()

///////////////////////////////////////////////////////////////////////////////
int open_blt(lua_State* L) {
   lua_settop(L, 0);

   int result = luaL_loadbufferx(L, BE_BLT_COMPILED_LUA_MODULE, BE_BLT_COMPILED_LUA_MODULE_LENGTH, "@BLT core", "b");
   if (result != LUA_OK) {
      throw std::runtime_error("Could not load compiled BLT support library!");
   }

   lua_pushcfunction(L, blt_compile);
   result = lua_pcall(L, 1, 1, 0);

   if (result != LUA_OK) {
      lua_newtable(L);
   }

   return 1;
}

///////////////////////////////////////////////////////////////////////////////
int open_blt_compile(lua_State* L) {
   lua_pushcfunction(L, blt_compile);
   return 1;
}

} // be::belua
} // be
